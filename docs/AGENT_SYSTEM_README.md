# ü§ñ –ê–≥–µ–Ω—Ç—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ Entertainment Planner

## üìã –û–±–∑–æ—Ä

–ê–≥–µ–Ω—Ç—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ Entertainment Planner - —ç—Ç–æ –º–Ω–æ–≥–æ–∞–≥–µ–Ω—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –º–µ—Å—Ç–∞—Ö –≤ –ë–∞–Ω–≥–∫–æ–∫–µ. –°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ü–µ–ø–æ—á–∫–µ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –≥–æ—Ç–æ–≤—ã–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –º–µ—Å—Ç–∞.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```
–ù–æ–≤—ã–µ –º–µ—Å—Ç–∞ (status: new)
    ‚Üì
GPT Worker (Summarizer Agent)
    ‚Üì
–°–∞–º–º–∞—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Å—Ç–∞ (status: summarized)
    ‚Üì
Enhanced Google Enrichment Agent
    ‚îú‚îÄ‚îÄ Google Places API (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
    ‚îî‚îÄ‚îÄ –í–µ–±-–ø–æ–∏—Å–∫ (—Ä–µ–∑–µ—Ä–≤)
    ‚Üì
–û–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞ (status: enriched)
    ‚Üì
AI Editor (Final Verification Agent)
    ‚Üì
–ü—É–±–ª–∏—á–Ω—ã–µ –º–µ—Å—Ç–∞ (status: published)
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
entertainment-planner-api/
‚îú‚îÄ‚îÄ .env                          # API –∫–ª—é—á–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ fixed_gpt_worker.py          # GPT –≤–æ—Ä–∫–µ—Ä (–æ—Å–Ω–æ–≤–Ω–æ–π)
‚îú‚îÄ‚îÄ enhanced_google_enrichment_agent.py  # Google –æ–±–æ–≥–∞—â–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ monitor_gpt_worker.py        # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPT –≤–æ—Ä–∫–µ—Ä–∞
‚îú‚îÄ‚îÄ monitor_google_enrichment.py # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Google –æ–±–æ–≥–∞—â–µ–Ω–∏—è
‚îú‚îÄ‚îÄ add_new_places.py           # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Å—Ç –∏–∑ CSV
‚îú‚îÄ‚îÄ check_progress.py           # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db.py               # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ places/
‚îÇ       ‚îú‚îÄ‚îÄ models.py           # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ       ‚îú‚îÄ‚îÄ services/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ google_places.py # Google Places API –∫–ª–∏–µ–Ω—Ç
‚îÇ       ‚îî‚îÄ‚îÄ workers/
‚îÇ           ‚îî‚îÄ‚îÄ gpt_client.py   # GPT API –∫–ª–∏–µ–Ω—Ç
‚îî‚îÄ‚îÄ docs/
    ‚îî‚îÄ‚îÄ places.csv/             # CSV —Ñ–∞–π–ª—ã —Å –Ω–æ–≤—ã–º–∏ –º–µ—Å—Ç–∞–º–∏
```

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `places`

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è:**
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞
- `description_full` - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- `category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è –º–µ—Å—Ç–∞
- `source` - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
- `source_url` - URL –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- `processing_status` - —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–°—Ç–∞—Ç—É—Å—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- `new` - –Ω–æ–≤–æ–µ –º–µ—Å—Ç–æ, —Ç—Ä–µ–±—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `summarized` - –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ GPT, –≥–æ—Ç–æ–≤–æ –∫ –æ–±–æ–≥–∞—â–µ–Ω–∏—é
- `enriched` - –æ–±–æ–≥–∞—â–µ–Ω–æ Google API, –≥–æ—Ç–æ–≤–æ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- `published` - –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ, –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- `error` - –æ—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–û–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –ø–æ–ª—è (Google API):**
- `lat`, `lng` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- `rating` - —Ä–µ–π—Ç–∏–Ω–≥ (1-5)
- `address` - –∞–¥—Ä–µ—Å
- `gmaps_place_id` - Google Place ID
- `gmaps_url` - —Å—Å—ã–ª–∫–∞ –Ω–∞ Google Maps
- `website` - –≤–µ–±-—Å–∞–π—Ç
- `phone` - —Ç–µ–ª–µ—Ñ–æ–Ω
- `picture_url` - —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è
- `business_status` - —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã
- `hours_json` - —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã (JSON)
- `utc_offset_minutes` - —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å

**GPT –ø–æ–ª—è:**
- `summary` - –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- `tags_csv` - —Ç–µ–≥–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
- `signals` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã (JSON)

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```bash
# OpenAI API
OPENAI_API_KEY=sk-proj-...

# Google Places API
GOOGLE_MAPS_API_KEY=AIza...

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
DATABASE_URL=postgresql://ep:ep@localhost:5432/ep

# Python –ø—É—Ç—å
PYTHONPATH=/Users/user/entertainment\ planner/entertainment-planner-api
```

### 2. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é API
cd entertainment-planner-api

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source ../venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export $(cat .env | xargs)
```

## üöÄ –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–æ–≤

### 1. GPT Worker (Summarizer Agent)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –º–µ—Å—Ç —á–µ—Ä–µ–∑ GPT –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∞–º–º–∞—Ä–∏, —Ç–µ–≥–æ–≤ –∏ —Å–∏–≥–Ω–∞–ª–æ–≤

**–ó–∞–ø—É—Å–∫:**
```bash
# –í —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
export $(cat .env | xargs) && nohup python fixed_gpt_worker.py > gpt_worker.log 2>&1 &

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
ps aux | grep fixed_gpt_worker

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤
tail -f gpt_worker.log
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –ü–æ–ª—É—á–∞–µ—Ç –º–µ—Å—Ç–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `new` –∏–∑ –ë–î
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–∞ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é –ë–î
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ GPT –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
4. –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—è: `summary`, `tags_csv`, `signals`, `processing_status`
5. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–µ—Å—Å–∏—é

### 2. Enhanced Google Enrichment Agent

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –º–µ—Å—Ç —á–µ—Ä–µ–∑ Google Places API –∏ –≤–µ–±-–ø–æ–∏—Å–∫

**–ó–∞–ø—É—Å–∫:**
```bash
# –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞
export $(cat .env | xargs) && python enhanced_google_enrichment_agent.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. **–ü–æ–ø—ã—Ç–∫–∞ 1**: –ü–æ–∏—Å–∫ –º–µ—Å—Ç–∞ —á–µ—Ä–µ–∑ Google Places API
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –∫ –≤–µ–±-–ø–æ–∏—Å–∫—É
2. **–ü–æ–ø—ã—Ç–∫–∞ 2**: –í–µ–±-–ø–æ–∏—Å–∫ –¥–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç
3. **–ü–æ–ø—ã—Ç–∫–∞ 3**: –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –º–µ—Å—Ç

**–û–±–æ–≥–∞—â–∞–µ–º—ã–µ –ø–æ–ª—è:**
- `lat`, `lng` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- `rating` - —Ä–µ–π—Ç–∏–Ω–≥ (1-5)
- `address` - –∞–¥—Ä–µ—Å
- `gmaps_place_id` - Google Place ID
- `website` - –≤–µ–±-—Å–∞–π—Ç
- `phone` - —Ç–µ–ª–µ—Ñ–æ–Ω
- `picture_url` - —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è
- `business_status` - —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã
- `hours_json` - —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã (JSON)

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:**
```bash
# –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
python check_progress.py

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPT –≤–æ—Ä–∫–µ—Ä–∞
python monitor_gpt_worker.py

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Google –æ–±–æ–≥–∞—â–µ–Ω–∏—è
python monitor_google_enrichment.py
```

## üìä –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Å—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ CSV —Ñ–∞–π–ª–æ–≤

CSV —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏:
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞
- `description_full` - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- `source_url` - URL –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
# –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
export $(cat .env | xargs) && python add_new_places.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –ß–∏—Ç–∞–µ—Ç CSV —Ñ–∞–π–ª—ã –∏–∑ `docs/places.csv/`
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ URL
3. –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –º–µ—Å—Ç–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `new`
4. –í—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö/–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –º–µ—Å—Ç

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –º–µ—Å—Ç –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ü–µ–ø–æ—á–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```bash
# 1. GPT –≤–æ—Ä–∫–µ—Ä (–≤ —Ñ–æ–Ω–µ)
export $(cat .env | xargs) && nohup python fixed_gpt_worker.py > gpt_worker.log 2>&1 &

# 2. –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è GPT –æ–±—Ä–∞–±–æ—Ç–∫–∏
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: python check_progress.py

# 3. Google –æ–±–æ–≥–∞—â–µ–Ω–∏–µ
export $(cat .env | xargs) && python enhanced_google_enrichment_agent.py

# 4. –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≥–æ—Ç–æ–≤—ã—Ö –º–µ—Å—Ç
export $(cat .env | xargs) && python -c "
from apps.core.db import SessionLocal
from apps.places.models import Place
from sqlalchemy import func
from datetime import datetime, timezone

db = SessionLocal()
try:
    places_to_publish = db.query(Place).filter(
        Place.processing_status == 'enriched',
        Place.summary.isnot(None),
        Place.lat.isnot(None),
        Place.lng.isnot(None)
    ).count()
    
    if places_to_publish > 0:
        db.query(Place).filter(
            Place.processing_status == 'enriched',
            Place.summary.isnot(None),
            Place.lat.isnot(None),
            Place.lng.isnot(None)
        ).update({
            'processing_status': 'published',
            'published_at': datetime.now(timezone.utc)
        })
        db.commit()
        print(f'‚úÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ {places_to_publish} –º–µ—Å—Ç!')
finally:
    db.close()
"
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
export $(cat .env | xargs) && python -c "
from apps.core.db import SessionLocal
from apps.places.models import Place
from sqlalchemy import func

db = SessionLocal()
try:
    statuses = db.query(Place.processing_status, func.count(Place.id)).group_by(Place.processing_status).all()
    print('üìä –°–¢–ê–¢–£–°–´ –ú–ï–°–¢:')
    for status, count in statuses:
        print(f'  {status}: {count}')
finally:
    db.close()
"
```

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

```bash
# GPT –≤–æ—Ä–∫–µ—Ä
tail -f gpt_worker.log

# Google –æ–±–æ–≥–∞—â–µ–Ω–∏–µ (–≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å)
# –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ enhanced_google_enrichment_agent.py
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫

```bash
# –ú–µ—Å—Ç–∞ —Å –æ—à–∏–±–∫–∞–º–∏
export $(cat .env | xargs) && python -c "
from apps.core.db import SessionLocal
from apps.places.models import Place

db = SessionLocal()
try:
    error_places = db.query(Place).filter(Place.processing_status == 'error').all()
    print(f'‚ùå –ú–µ—Å—Ç —Å –æ—à–∏–±–∫–∞–º–∏: {len(error_places)}')
    for place in error_places:
        print(f'  - {place.name}: {place.last_error}')
finally:
    db.close()
"
```

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### 1. GPT Worker –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** `IdleInTransactionSessionTimeout`
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `fixed_gpt_worker.py` - –æ–Ω —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–∞

### 2. Google API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- API –∫–ª—é—á –≤ `.env` —Ñ–∞–π–ª–µ
- –õ–∏–º–∏—Ç—ã Google Places API
- –°–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### 3. –ú–µ—Å—Ç–∞ –Ω–µ –æ–±–æ–≥–∞—â–∞—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- –°—Ç–∞—Ç—É—Å –º–µ—Å—Ç (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `summarized`)
- –ù–∞–ª–∏—á–∏–µ `description_full` —É –º–µ—Å—Ç
- –õ–æ–≥–∏ Google –æ–±–æ–≥–∞—â–µ–Ω–∏—è

### 4. –û—à–∏–±–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
- –ü–µ—Ä–µ–º–µ–Ω–Ω—É—é `DATABASE_URL` –≤ `.env`
- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (2025-09-21)

- **–í—Å–µ–≥–æ –º–µ—Å—Ç**: 1873
- **üì∞ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ**: 1640 –º–µ—Å—Ç (87.5%)
- **üîç –û–±–æ–≥–∞—â–µ–Ω–æ**: 227 –º–µ—Å—Ç (12.1%)
- **üìù –ì–æ—Ç–æ–≤—ã –∫ –æ–±–æ–≥–∞—â–µ–Ω–∏—é**: 6 –º–µ—Å—Ç (0.3%)

### –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –∞–≥–µ–Ω—Ç–æ–≤

- **GPT Worker**: 100% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **Google Enrichment**: 100% —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–±–æ–≥–∞—â–µ–Ω–∏—è
  - Google Places API: 94.8% –º–µ—Å—Ç
  - –í–µ–±-–ø–æ–∏—Å–∫: 5.2% –º–µ—Å—Ç

## üîÑ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏

1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Å—Ç** –∏–∑ CSV —Ñ–∞–π–ª–æ–≤
2. **GPT –æ–±—Ä–∞–±–æ—Ç–∫–∞** - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∞–º–º–∞—Ä–∏, —Ç–µ–≥–æ–≤, —Å–∏–≥–Ω–∞–ª–æ–≤
3. **Google –æ–±–æ–≥–∞—â–µ–Ω–∏–µ** - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, —Ä–µ–π—Ç–∏–Ω–≥–∏, –∞–¥—Ä–µ—Å–∞, —Ñ–æ—Ç–æ
4. **–ü—É–±–ª–∏–∫–∞—Ü–∏—è** - –ø–µ—Ä–µ–≤–æ–¥ –≤ —Å—Ç–∞—Ç—É—Å `published`

**–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- GPT Worker: ~5-10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –º–µ—Å—Ç–æ
- Google Enrichment: ~2-3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –º–µ—Å—Ç–æ
- –û–±—â–µ–µ –≤—Ä–µ–º—è: ~10-15 –º–∏–Ω—É—Ç –Ω–∞ 100 –º–µ—Å—Ç

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∞–≥–µ–Ω—Ç–æ–≤
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –Ω–µ–ø–æ–ª–∞–¥–æ–∫

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-09-21
**–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã:** 2.0 (Enhanced Google Enrichment Agent)
