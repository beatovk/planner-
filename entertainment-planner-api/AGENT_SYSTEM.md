# ü§ñ –ê–≥–µ–Ω—Ç—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ Entertainment Planner

## –û–±–∑–æ—Ä

–ê–≥–µ–Ω—Ç—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ Entertainment Planner - —ç—Ç–æ –º–Ω–æ–≥–æ–∞–≥–µ–Ω—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏, –æ–±–æ–≥–∞—â–µ–Ω–∏—è –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ –º–µ—Å—Ç–∞—Ö —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π –≤ –ë–∞–Ω–≥–∫–æ–∫–µ.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ü–∞—Ä—Å–µ—Ä—ã       ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  GPT Normalizer ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Google Enricher ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   AI Editor     ‚îÇ
‚îÇ (Data Ingestion)‚îÇ    ‚îÇ  (Summarizer)   ‚îÇ    ‚îÇ   (Enricher)    ‚îÇ    ‚îÇ (Verification)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚ñº                       ‚ñº                       ‚ñº                       ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  new    ‚îÇ            ‚îÇsummarized‚îÇ           ‚îÇ enriched‚îÇ            ‚îÇpublished‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –°—Ç–∞—Ç—É—Å—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏

- **`new`** - –Ω–æ–≤–æ–µ –º–µ—Å—Ç–æ, —Ç—Ä–µ–±—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **`summarized`** - –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ GPT, –µ—Å—Ç—å —Å–∞–º–º–∞—Ä–∏ –∏ —Ç–µ–≥–∏
- **`enriched`** - –æ–±–æ–≥–∞—â–µ–Ω–æ Google API –¥–∞–Ω–Ω—ã–º–∏
- **`published`** - –≥–æ—Ç–æ–≤–æ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- **`needs_revision`** - —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- **`review_pending`** - –æ–∂–∏–¥–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- **`failed`** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞

## üîß –ê–≥–µ–Ω—Ç—ã

### 1. –ü–∞—Ä—Å–µ—Ä—ã (Data Ingestion Agents)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–µ–±-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
- `apps/places/ingestion/timeout_adapter.py` - TimeOut Bangkok
- `apps/places/ingestion/bk_magazine_adapter.py` - BK Magazine

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: URL —Å—Ç–∞—Ç–µ–π –∏ –∫–∞—Ç–∞–ª–æ–≥–æ–≤
**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Å—Ç–∞—Ö

### 2. GPT Normalizer (Summarizer Agent)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ GPT-4o-mini

**–§—É–Ω–∫—Ü–∏–∏**:
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∞—Ç–∫–∏—Ö —Å–∞–º–º–∞—Ä–∏ (3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, ‚â§250 —Å–∏–º–≤–æ–ª–æ–≤)
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ç–µ–≥–æ–≤ —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏ (category:, vibe:, experience: –∏ –¥—Ä.)
- –î–µ—Ç–µ–∫—Ü–∏—è Interest Signals (–±—É–ª–µ–≤—ã–µ —Ñ–ª–∞–≥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π)
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è (—Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã, –±–∞—Ä—ã, –∫–∞—Ñ–µ, —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: `apps/places/workers/gpt_normalizer.py`

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Å—Ç–µ
**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∞–º–º–∞—Ä–∏, —Ç–µ–≥–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, interest_signals

### 3. Google API Enrichment Agent

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Google Places API

**–§—É–Ω–∫—Ü–∏–∏**:
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ—á–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤
- –ü–æ–∏—Å–∫ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è —Ü–µ–Ω

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: `apps/places/workers/google_enricher_worker.py`

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –±–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Å—Ç–µ
**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –û–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å Google API

### 4. AI Editor (Final Verification Agent)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–§—É–Ω–∫—Ü–∏–∏**:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- –ü–æ–∏—Å–∫ –ª—É—á—à–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö
- –ó–∞–ø—É—Å–∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: `apps/places/workers/ai_editor.py`

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Å—Ç–µ
**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ —É–ª—É—á—à–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## üìä –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
- **`website`** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –∑–∞–≤–µ–¥–µ–Ω–∏—è
- **`phone`** - –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω
- **`price_level`** - —É—Ä–æ–≤–µ–Ω—å —Ü–µ–Ω (0-4)
- **`business_status`** - —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã (OPERATIONAL, CLOSED_TEMPORARILY)
- **`hours_json`** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- **`address`** - –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å –∏–∑ Google Maps
- **`interest_signals`** - JSON —Å –±—É–ª–µ–≤—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π (–Ω–æ–≤–æ–µ –ø–æ–ª–µ)

#### Interest Signals (–¥–µ—Ç–µ–∫—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π)
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–∞:

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π:**
- `nightlife_music` - –Ω–æ—á–Ω–∞—è –∂–∏–∑–Ω—å –∏ –º—É–∑—ã–∫–∞ (rooftop_sunset, live_jazz, edm_club_night)
- `food_drink` - –µ–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏ (street_food_safari, michelin_bib_run, coffee_roastery_tour)
- `culture_art_heritage` - –∫—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ (temple_morning_walk, gallery_hop, street_art_tour)
- `workshops_makers` - –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã (pottery_wheel_class, barista_foundations, mixology_masterclass)
- `active_adventure_city` - –∞–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö (muay_thai_class, climbing, escape_room)
- `nature_daytrips` - –ø—Ä–∏—Ä–æ–¥–∞ –∏ –ø–æ–µ–∑–¥–∫–∏ (bang_krachao_bike_loop, ayutthaya_day_trip)
- `wellness_recovery` - –∑–¥–æ—Ä–æ–≤—å–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (thai_massage_course, luxury_spa_day)
- `family_kids_play` - —Å–µ–º—å—è –∏ –¥–µ—Ç–∏ (aquarium_visit, theme_park_day, kids_cooking_class)
- `shopping_lifestyle` - —à–æ–ø–∏–Ω–≥ (chatuchak_weekend_market, vinyl_record_digging)
- `urban_unique` - –≥–æ—Ä–æ–¥—Å–∫–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (rooftop_cinema, secret_supper_club)

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "food_drink": true,
  "family_kids_play": true,
  "nightlife_music": false,
  "culture_art_heritage": false
}
```

### Google API –ø–æ–ª—è
- **`gmaps_place_id`** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –º–µ—Å—Ç–∞ –≤ Google Maps
- **`gmaps_url`** - –ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –º–µ—Å—Ç–æ –≤ Google Maps
- **`utc_offset_minutes`** - —Å–º–µ—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç UTC

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source ../venv/bin/activate

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é —Ü–µ–ø–æ—á–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏
./run_pipeline.sh

# –ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç—Ç–∞–ø—ã
./run_pipeline.sh gpt        # GPT –æ–±—Ä–∞–±–æ—Ç–∫–∞
./run_pipeline.sh google     # Google –æ–±–æ–≥–∞—â–µ–Ω–∏–µ  
./run_pipeline.sh ai_editor  # AI –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

# –°–ø—Ä–∞–≤–∫–∞
./run_pipeline.sh --help
```

### –ü—Ä—è–º—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞
python run_full_pipeline.py

# –û—Ç–¥–µ–ª—å–Ω—ã–µ —ç—Ç–∞–ø—ã
python run_full_pipeline.py --stage gpt
python run_full_pipeline.py --stage google
python run_full_pipeline.py --stage ai_editor

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
python apps/places/commands/run_gpt_worker.py --batch-size 10
python apps/places/commands/enrich_google.py --batch-size 20
python apps/places/commands/run_ai_editor.py --batch-size 5
```

### –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã (–Ω–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
export ORCH_V2_ENABLED=true
export CANARY_PERCENTAGE=100.0

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Å—Ç–∞
python -c "
from apps.places.orchestrator import process_place
result = process_place(place_id)
print(f'–†–µ–∑—É–ª—å—Ç–∞—Ç: {result}')
"

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –º–µ—Å—Ç
python -c "
from apps.places.orchestrator import process_place
from apps.core.db import SessionLocal
from apps.places.models import Place

db = SessionLocal()
new_places = db.query(Place).filter(Place.processing_status == 'new').all()

for place in new_places:
    result = process_place(place.id)
    print(f'–ú–µ—Å—Ç–æ {place.name}: {result}')
"
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–≥–µ–Ω—Ç–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –º–µ—Å—Ç
python -c "
from apps.core.db import SessionLocal
from apps.places.models import Place
from collections import Counter

db = SessionLocal()
statuses = [p.processing_status for p in db.query(Place).all()]
print('–°—Ç–∞—Ç—É—Å—ã:', Counter(statuses))
"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
python -c "
from apps.core.db import SessionLocal
from apps.places.models import Place

db = SessionLocal()
places_with_website = db.query(Place).filter(Place.website.isnot(None)).count()
places_with_phone = db.query(Place).filter(Place.phone.isnot(None)).count()
places_with_price = db.query(Place).filter(Place.price_level.isnot(None)).count()

print(f'–ú–µ—Å—Ç —Å —Å–∞–π—Ç–æ–º: {places_with_website}')
print(f'–ú–µ—Å—Ç —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º: {places_with_phone}')
print(f'–ú–µ—Å—Ç —Å —Ü–µ–Ω–æ–π: {places_with_price}')
"
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# OpenAI API
OPENAI_API_KEY=sk-proj-...

# Google Maps API
GOOGLE_MAPS_API_KEY=AIza...

# –ê–≥–µ–Ω—Ç—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞
ORCH_V2_ENABLED=true
CANARY_PERCENTAGE=100.0

# PYTHONPATH (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ ~/.zshrc)
export PYTHONPATH="/Users/user/entertainment planner/entertainment-planner-api"
```

### –£–¥–æ–±–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

**`run_pipeline.sh`** - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç PYTHONPATH
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ

**`PIPELINE_GUIDE.md`** - –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ü–µ–ø–æ—á–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤

```python
# apps/places/orchestrator.py
ORCH_V2_ENABLED = os.getenv('ORCH_V2_ENABLED', 'false').lower() == 'true'
CANARY_PERCENTAGE = float(os.getenv('CANARY_PERCENTAGE', '10.0'))
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–µ—Å—Ç–∞**: 2-5 —Å–µ–∫—É–Ω–¥
- **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏**: 95%+
- **–ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö**: 90%+ –ø–æ–ª–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Google API
- **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **Retry –ª–æ–≥–∏–∫–∞** –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
- **Idempotency** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
import logging
logging.basicConfig(level=logging.INFO)

# –õ–æ–≥–∏ –∞–≥–µ–Ω—Ç–æ–≤
logger = logging.getLogger('apps.places.workers')
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Å—Ç–∞
place = db.query(Place).get(place_id)
print(f'–°—Ç–∞—Ç—É—Å: {place.processing_status}')
print(f'–ü–æ–ø—ã—Ç–∫–∏: {place.attempts}')
print(f'–û—à–∏–±–∫–∏: {place.last_error}')
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤
```python
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GPT Normalizer
from apps.places.workers.gpt_normalizer import GPTNormalizerWorker
worker = GPTNormalizerWorker()
result = worker.process_place(place_id)

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Google Enricher
from apps.places.workers.google_enricher_worker import GoogleEnricherWorker
worker = GoogleEnricherWorker(mock_mode=False)
result = worker.enrich_place(place_name, place_address)

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ AI Editor
from apps.places.workers.ai_editor import AIEditorAgent
agent = AIEditorAgent()
result = agent.process_place(place_id)
```

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-2 –º–µ—Å—è—Ü–∞)
- [ ] –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª–µ–π –∏–∑ Google API
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (3-6 –º–µ—Å—è—Ü–µ–≤)
- [ ] –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (6+ –º–µ—Å—è—Ü–µ–≤)
- [ ] –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- [ ] –ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å IoT —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **API Docs**: http://localhost:8000/docs
- **Roadmap**: [docs/roadmap.md](../docs/roadmap.md)
- **–û—Å–Ω–æ–≤–Ω–æ–π README**: [README.md](../README.md)

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
**–í–µ—Ä—Å–∏—è**: 2.0.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-01-27
